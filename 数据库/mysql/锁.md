

## 锁的粒度
表锁与行锁的区别:
* 锁定粒度-表锁 > 行锁
* 加锁效率-表锁 > 行锁
* 冲突概率-表锁 > 行锁
* 并发性能-表锁 < 行锁

### 共享锁(Share S锁) 行锁
又称读锁，共享锁就是多个事务对同一数据可以共享一把锁，都能访问到数据，但是只能读不能修改；
```sql
# 加锁方式
select * from student where id = 1 LOCK IN SHARE MODE;
# 释放锁
commit/rollback;
```

### 排他锁(X 锁) 行锁
又称为写锁，排他锁不能与其他锁并存，如果一个事务获取了一个数据行的排他锁，其他事务就不能再获取该行的锁(共享锁、排他锁)，只有获取了排他锁的事务是可以对数据进行读取和修改。
```sql
# 加锁方式
# 自动
delete / update /insert 默认加上X锁;
# 手动
select * from student where id=1 FOR UPDATE;
```

### 意向共享锁(IS)/意向排他锁(IX) 表锁，一个标志
* 意向锁是由数据引擎自己维护的，用户无法手动操作意向锁，意向共享锁(Intention Shared Lock，简称IS锁)。  
> 表示事务准备给数据行加入共享锁，也就是一个数据行加共享锁必须先取得该表的IS锁。

* 意向排他锁(Intention Exclusion Lock，简称IX锁)；
> 表示事务准备给数据行加入排他锁，说明事务在一个数据行加排他锁前必须先取得该表的IX锁。

>> 给一张表加表锁的前提：  
>>>没有任何事务已经锁定表的任意一行数据，需要进行全表扫描。有了意向锁，就相当flag。
